# TradingBot-Typescript

## Description

[Crewvity.com](https://crewvity.com) integrated trading bot template project. Other notable key points...

- Integrated with [Coincap.io](https://coincap.io/) for every minute real-time market data streaming
- Tech stack
  - Typescript
  - [NestJS](https://nestjs.com/)
  - [Sentry] (https://sentry.io/)
  - [TypeORM](https://typeorm.io/)
  - Postgres (Docker)
- Base code generated by NestJS which is lean and minimal
- Fully functional technical trading strategies included

## Tutorial Video

[Code Crypto Trading Bot like a Pro](https://www.youtube.com/watch?v=nkSc4Q1u9tI&t=470s)

## Installation

1. `docker-compose up -d`
   - Starts up the database as a Docker container
1. `yarn install`
1. `touch .env`
1. Copy all the values from `.env.example` to `.env`
1. Fill out the missing values in `.env`
   - COINCAP_API_KEY: can be obtained from [Coincap doc](https://docs.coincap.io/)
   - CREWVITY_API_KEY: can be obtained from "Settings" after logging in from [Crewvity.com](https://crewvity.com)

## Setting up example strategies

We need to link the strategy variants defined in this trading bot with the strategies that are registered in [Crewvity](https://crewvity.com).

1. Login to [Crewvity](https://crewvity.com)
1. Add three strategies with below names and get their strategy IDs
   - MacCross-BTC-Fast
   - MacCross-BTC-Medium
   - MacCross-BTC-Slow
1. Paste the crewvity strategy IDs into [add-strategy.ts](src/cli-command/strategy/add-strategy.ts)
1. Run the script with `yarn cmd add-strategy` from the root folder
1. Run the server `yarn start:dev` and strategies should initialise and start running automatically

[add-strategy.ts](src/cli-command/strategy/add-strategy.ts) script here is a [NestJS Commander](https://docs.nestjs.com/recipes/nest-commander) script.

## Modules

Entire codebase is organised by [NestJS Modules](https://docs.nestjs.com/modules), each responsible for a specific domain.

- cli-command: all [NestJS Commander](https://docs.nestjs.com/recipes/nest-commander) scripts
- commons: any commonly shared code across all other modules
- crewvity: integration with [Crewvity API](https://crewvity-production.up.railway.app/api)
- database: integration with database. All TypeORM entities should be defined here.
- market-data: market data provider for all the tradable assets
- strategy: manages all trading bot strategies

## Running the app

```bash
# development
$ yarn start

# watch mode
$ yarn start:dev

# production mode
$ yarn start:prod
```

## Error Handling

- Error handling / reporting is critical for a trading bot to ensure anomalies are caught and dealt with ASAP as we are dealing with real money
- Sentry is initialised at server startup in the [main.ts](src/main.ts)
- Reporting to sentry can be done using the [reportError()](src/commons/error-handlers/report-error.ts)

### Recommended Error Throw Pattern

1. Catch errors with try-catch wherever you want to manually handle them
2. Wrap the error with [TradingBotException](src/commons/errors/trading-bot-exception.ts) with all the context you can get at the level you caught the error
3. Throw the [TradingBotException](src/commons/errors/trading-bot-exception.ts) up again
4. At any level higher up the chain, you can catch the [TradingBotException](src/commons/errors/trading-bot-exception.ts) and wrap it again with another [TradingBotException](src/commons/errors/trading-bot-exception.ts) with all the context information available at that level.
5. Eventually you will have to use the [reportError()](src/commons/error-handlers/report-error.ts) or use [@CatchErrors()](src/commons/error-handlers/catch-errors-decorator.ts) decorator to report to Sentury. To see examples of these, please search the codebase of their usages.

## Contributors

- Engineers at [Crewvity](https://crewvity.com)
- [Kurdiez YouTube](https://www.youtube.com/@kurdiez_en)
- [Join us as a contributor... hello@crewvity.com]

## License

This project is [MIT licensed](LICENSE).
